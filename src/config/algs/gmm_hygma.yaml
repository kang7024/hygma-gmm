# --- HGCN-QMIX specific parameters ---

# use epsilon greedy action selector
action_selector: "epsilon_greedy"
epsilon_start: 1.0
epsilon_finish: 0.05
epsilon_anneal_time: 100000
evaluation_epsilon: 0.0

# Optimizer
optim_beta1: 0.9  # AdamW first moment coefficient
optim_beta2: 0.999  # AdamW second moment coefficient
optim_eps: 1e-8  # Small value for numerical stability
weight_decay: 0.01  # Weight decay

# Runner configuration
batch_size_run: 1  # Number of environments to run in parallel
runner: "episode"  # Runs 1 env for an episode

# Multi-Agent Controller
mac: "gmm_hygma_mac"

# Training parameters
use_rnn: True
batch_size: 128  # Number of episodes to train on
buffer_size: 5000  # Size of the replay buffer

# Target network update
target_update_interval: 200  # Update the target network every 200 episodes

# Learner and mixer configuration
agent_output_type: "q"
learner: "hgcn_learner"
double_q: True
mixer: "qmix"
mixing_embed_dim: 32
hypernet_layers: 2
hypernet_embed: 64

# Clustering related configuration
clustering_interval: 100000  # Check clustering every 100000 timesteps (안정성 유지)
state_history_length: 5000  # State history length for clustering (데이터 풍부화)
behavior_history_length: 5000  # Behavior history length for clustering
stability_threshold: 0.6  # Keep existing grouping if less than 30% of agents need to move (적당한 민감도)
min_clusters: 2  # Minimum number of clusters
max_clusters: 3  # Maximum number of clusters (유연성 증가)

# Fixed grouping steps
fix_grouping_steps: 2  # Fix grouping for initial 2 steps
fix_hgcn_steps: 2  # Fix HGCN for initial 2 steps

# HGCN related configuration
hgcn_out_dim: 48  # Output dimension of HGCN
hgcn_hidden_dim: 64  # Hidden dimension of HGCN
hgcn_num_layers: 2  # Number of HGCN layers

# Loss hyperparameters
lambda_consistency: 0.001  # Consistency loss weight
lambda_attention: 0.01  # Attention loss weight

# Model name
name: "gmm_hygma"

# GMM-specific parameters
gmm_cov_type: "diag"  # Use diagonal covariance for computational efficiency
gmm_reg_covar: 1e-4  # Regularization for covariance matrix (numerical stability)
soft_threshold: 0.15  # Threshold for soft assignment (multi-group membership)